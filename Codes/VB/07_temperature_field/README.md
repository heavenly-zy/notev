# 二维有限差分法温度场模拟程序

## 计算公式

由于是二维，所以所有需要使用体积进行计算的地方均使用面积代替，接触面也变成了接触宽度，最后计算所得的热量单位应为 $J/m$ ，但由于单元热平衡法两侧单位一致，直接计算即可

### 有限差分法

使用单元热平衡法对 $s \times w$ 大小的微元进行分析

考察任意两个相邻结点之间的热交换，令 $s$ 为相邻两结点间的接触宽度， $w$ 为目的结点在沿两结点连线方向的厚度， $s \times w$ 应为该微元的面积（“体积”）

> 由于相邻结点之间的传热是相反的，可计算一次后传入热量缓冲矩阵，计算时间可以减半（可能后续完成，不过一般说完我都不做了:joy:）

-  从相邻结点获得的热量 $Q_k = k \frac{T' - T}{d} \cdot s \cdot \Delta \tau$
-  从空气获得的热量 $Q_h = h (T_{AIR} - T) \cdot s \cdot \Delta \tau$

故总热量 $Q$ 应为上下左右四方向传热加和

又 $Q = c m \Delta T = c \rho s w \Delta T$ ，可计算出最终的热量

### 铸件-铸型界面模型

可计算得 当量 $k$ 应为 $\frac{2 k_1 k_2}{k_1 + k_2}$ ，即 计算铸件铸型之间换热时使用该 $k$ 替换原有 $k$

### 潜热的计算

由于金属（合金）凝固时会释放潜热，会延缓结晶温度区间的温度变化，故需要一定处理手段，这里使用温度（热量）补偿法，利用潜热矩阵记录剩下的潜热

由于 $c \Delta T = L$ ，故 $Q_L = c m \Delta T = c \rho s w \Delta T$

在凝固点（液相线）下，根据潜热抵消已释放的热量部分

### 收敛判据

-  $\frac{k_M \Delta t}{c_M \rho_M d^2} \leq \frac{1}{4}$
-  $\frac{k_S \Delta t}{c_S \rho_S d^2} \leq \frac{1}{4 (1 + B)}$

其中 $B = \frac{h \cdot s}{k_S}$
