# Mathematical Modeling <Badge text="alpha" type="warn"/> <Badge text="1.4.2"/>

## Part 1 案例部分

## 1 马尔萨斯人口论

1. 已知当前或过去某个时刻的人口数量，预测未来某个时刻的人口？
2. 遥远未来的趋势（$t$ 趋于无穷）？

### 1.1 马尔萨斯人口模型

#### 1.1.1 高尔斯模型

人口可以表示为一组数对 $(t, P(t))$，即某一时刻 $t$ 的人口规模为 $P(t)$ ，如果用 $b$ 和 $d$ ，分别表示出生率和死亡率，那么**次年**人口总数将是

$$
p + bp -dp = (1 + b - d)p = (1 + r)p
$$

这里用自然增长率 $r$ 表示 $b - d$

#### 1.1.2 马尔萨斯人口模型

当然，上面那是一个离散的模型，但它可以给我们带来这样的启发：

人口在一段时间的变化量应当是正比于自然增长率 $r$、人口基数 $P(t)$、这段时间 $\Delta t$，也就是说：

$$
P(t + \Delta t) - P(t) = r P(t) \Delta t
$$

如果我们令 $t$ 趋于无穷小，很明显：

$$
\frac{d P(t)}{dt} = r P(t)
$$

嗯，就是一个微分方程，如果我们令 $P_0 = P(t_0)$，那么：

$$
P(t) = P_0 e^{r(t-t_0)}
$$

这说明，人口是**指数增长**的

当时马尔萨斯也利用某些地区的人口数据对模型进行了论证，结果表明他的模型比较好，但是那是 200 年前，**数学模型只是现实世界的数学简化**，所以它很可能只满足于某个特定情况，200 年后？

#### 1.1.3 数模基本流程

![MM01](../Images/MM01.png?raw=true)

### 1.2 Logistic 模型

#### 1.2.1 马尔萨斯模型“错”在哪里？

$$
P(t + \Delta t) - P(t) = r P(t) \Delta t
$$

我们认为一段时间人口的增长正比于这三项应当是没有问题的，但是有一个关键的问题就是，我们不应该将自然增长率 $r$ 当做一个常数来看，因为很明显，我们地球上的资源是有限的，所以当人口增长到一定程度后将受限于资源，故增长率将会降低

#### 1.2.2 怎么校正模型？

那就是说，我们可以让原来的 $r$ 变成时间的函数，它直接相关于人口数量 $P(t)$：

$$
r(t) = r(P(t)) = r \cdot \left(1 - \frac{P(t)}{K}\right)
$$

这里的 $K$，是新引进的一个参数，表征了地球所能容纳人口的上限，很明显，当人口达到这个上限自然增长率将会是 0，人口不再增长，这应当是合理的

我们新的模型引入了新的参数，使得模型变得复杂了，但也使得模型可以描述的问题变得复杂了，比如这里就考虑到了资源的问题，可是这并不能说明马尔萨斯当年的模型是错的，从历史上看当年确实并不需要考虑太多资源问题，从模型上看，我们可以看到当 $P(t)$足够小的时候，$r(t) = r$，所以说马尔萨斯当年得出的模型也是有道理的

> 增加一个参数会引发更多的争议

#### 1.2.3 求解新模型

$$
\begin{aligned}
\frac{dN(t)}{dt} & = r \left(1 - \frac{N(t)}{K} \right) N(t) \\
N(t_0) & = N_0
\end{aligned}
$$

解得

$$
\begin{aligned}
N(t) & = \frac{K}{1 + C e^{-r(t-t_0)}} \\
C & = \frac{K - P_0}{P_0}
\end{aligned}
$$

趋势：

![MM02](../Images/MM02.png?raw=true)

无论大于 $K$，还是小于 $K$，都会渐进于 $K$

#### 1.2.4 离散化？

我们将微分方程

$$
\frac{dN(t)}{dt} = r \left(1 - \frac{N(t)}{K} \right) N(t)
$$

离散化为差分方程

$$
\begin{aligned}
\frac{\Delta N(t)}{\Delta t} & = r \left(1 - \frac{N(t)}{K} \right) N(t) \\
\Delta N & = N_{t+1} - N_t \\
\Delta t & = 1
\end{aligned}
$$

则

$$
\begin{aligned}
N_{t+1} - N_t & = rN_t \left(1 - \frac{N_t}{K}\right) \\
N_{t+1} & = (1 + r) N_t - \frac{r}{K} N_t^2
\end{aligned}
$$

我们取定参数 $K$，考虑不同的参数 $r$（计算机模拟下）

1. 首先，$r$ 取 1.9 试试

![MM03](../Images/MM03.png?raw=true)

（左面是相图，和右面表示的其实是同样的）

很明显，最终我们能得到一个稳态解 $K$，或者说收敛于 $K$

2. 然后增大点，取 2.2 试试

![MM04](../Images/MM04.png?raw=true)

咦？居然不收敛了，最终会有一个 2 周期的解

3. 2.5

![MM05](../Images/MM05.png?raw=true)

4 周期的解，越来越复杂了

4. 2.55

![MM06](../Images/MM06.png?raw=true)

5. 我们将各个 $r$ 及其对应的“解” plot 出来，可以看到

![MM07](../Images/MM07.png?raw=true)

很明显，我们在 $r=2$ 之后开始有了 2 周期的解， $r=2.45$ 附近就有了 4 周期的解，很快地， $r=2.55$ 之前便有了 8 周期的解，模型越来越复杂

6. 我们再看下 $r=3.0$ 时，这时模型已经非常复杂了，这个时候我们可以看到**混沌**的现象，就是，对初值做一个小的扰动，之后整个的曲线的变化会非常大，即**对初值的敏感的依赖**

![MM08](../Images/MM08.png?raw=true)

![MM09](../Images/MM09.png?raw=true)

### 1.3 Leslie 模型

#### 1.3.1 考虑下人口分布

我们的 Logistic 模型只关注于人口总量，但是事实上我们人口分布也是非常重要的，比如说年龄分布，一个全是青年的分布与一个全是老年的分布的趋势肯定是不一样的，那么怎么建立新的模型呢？

### 1.3.2 重新建模

比如我们现在按每 1 年将人口进行切分，比如说不到一岁的人就叫 $n_0$，不到两岁就叫 $n_1$ ……很明显，我们现在将某一时刻的人口切分成了一个矩阵

$$
\mathbf{N}_t =  \begin{pmatrix}
n_0\\
n_1\\
\vdots\\
n_s
\end{pmatrix}_t
$$

我们分别考虑下各年龄人口的数量

1. 新生儿，他们来源于各个年龄段的贡献，故每个年龄都会有这么一个出生率 $F_i$

$$
n_{0,t+1} = F_0 n_{0,t} + F_1 n_{1,t} + \cdots + F_s n_{s,t}
$$

2. 非新生儿，这个时候需要考虑他们的死亡率 $(1 - p_s)$，$p_i$ 也就是他们的存活率

$$
\begin{aligned}
n_{1,t+1} & = p_0 n_{0,t} \\
\cdots & \cdots\\
n_{s,t+1} & = p_{s-1} n_{s-1,t}
\end{aligned}
$$

所以说，我们现在就会有好多好多的参数，这取决于我们切分的份数 $s$，参数将会有 $(s+1) + s = (2s + 1)$ 个

如果把 Leslie 模型写成矩阵形式

$$
N_{t+1} = L N_t
$$

其中

$$
\mathbf{L}_t =  \begin{pmatrix}
F_0 & F_1 & F_2 & \cdots & F_s \\
p_0 & 0 & 0 & \cdots & 0 \\
0 & p_1 & 0 & \cdots & 0 \\
\vdots & \vdots & \ddots & \ddots & \vdots \\
0 & 0 & \cdots & p_{s-1} & 0
\end{pmatrix}
$$

> 模型变难了，参数变多了，我们虽然能估计出来某些参数的值，但是难免带有主观因素，所以我们只有在“迫不得已”的情况下才会选用更复杂的模型，比如说我们就是要考虑各年龄的分布问题时

#### 1.3.3 继续求解

任意时刻的还是比较简单，我们只需要在 $N_t$ 基础上乘上 $L$，就很容易地得出 $N_{t+1}$，但是我们如何得到它的渐进性质呢？

首先假设 $L$ 的特征值 $\lambda_0, \lambda_1, \cdots ,\lambda_s$ 及其相应的特征向量 $\nu_0, \nu_1, \cdots ,\nu_s$ ，如果说所有的特征值都是不一样的，那么初始值 $N_0$ 一定可以表示为

$$
N_0 = c_0\nu_0 + \sum_{i=1}^s c_i \nu_i
$$

之后某一时刻的人口数量只需要乘 $L$，也就是

$$
N_t = c_0 (\lambda_0)^t \nu_0 + \sum_{i=1}^s c_i(\lambda_i)^t \nu_i
$$

不妨假设 $\lambda_0$ 是所有特征值里模最大的那个，则有

$$
\lim_{t\to\infty} N_t \propto c_0(\lambda_0)^t \nu_0
$$

也就是说，它的渐进状态是由**首特征值的大小**决定的

-  $|\lambda_0| > 1$ 无限增长下去
-  $|\lambda_0| < 1$ 最终灭亡
-  $|\lambda_0| = 1$ 收敛在一个稳定值

渐进状态由首特征值大小决定，而首特征值大小又是由各个参数决定的，这使得问题变得很是复杂，任何一个参数估计有所偏差会使得最终的预估有很大偏差

> 所有的模型都是错的，但有些是有用的
> 每个模型都不能将现实世界的全貌描述出来，但是有很多模型是可以很好地拟合某个条件下的一个问题，这就可以说是有用的，只要是有用的，便是好的

### 1.4 更复杂的模型

#### 1.4.1 又是什么需求？

我们知道，只有在有更好的需求的时候才需要更复杂的模型，在能解决问题的情况下，模型是越简单越好的，但是我们现在又有什么样的需求呢？

我们刚刚的 Leslie 模型是一个**离散化**的模型，就像从高尔斯模型到马尔萨斯模型一样，我们可以将这个离散化的模型变成连续的，并不按几年进行分割，或者说这个“几年”取个极小的极限，我们有可能是对这种模型是有需求的，因为这种模型描述的会更加准确，但是参数也会更加的多

由于原来出生率存活率都是依赖于分割的时间段的，如今时间段趋于无穷小，那么出生率存活率自然是无穷多的参数了，或者说会是一个函数，这使得模型复杂得多，但如果我们能得到比较准确的函数，那么这个模型也会更加的准确

![MM10](../Images/MM10.png?raw=true)

#### 1.4.2 还有呐？

之前我们是考虑了年龄的分布，但是地域分布呐？移民的影响呐？

…… （所有的模型都是错的） ……

> 有些时候有些参数很难估计出来，也许我们会选择随机模型，使得模型有着一定的不确定性，反映问题本身可能有的不确定性

# Amendant Record

1. 190101 #1 Finished

# Reference

1. [走近数学——数学建模篇 - 全国大学生数学建模竞赛组织委员会 - 中国大学 MOOC](https://www.icourse163.org/course/cumcm-1001674011?tid=1003045001)
2. 《数学建模算法与应用（第二版）》 司守奎 孙兆亮

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/katex.min.css">
