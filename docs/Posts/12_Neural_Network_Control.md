---
title: Neural Network Control
date: 2019-06-09
categories:
   - 百家·集
tags:
   - DL
---

源于必修课材料成型过程检测及控制一次 Pre ，最初只想扯到 AI ，直到某一天无意中扫到 PPT 扩展内容中提到了这个，就强行扯到这里了（当时我是无比开心的），当然，神经网络控制（NNC）本就是先进过程控制（APC）的一个重要分支啦，也是没有跑题的说（理直气壮.jpg）

<!-- more -->

## 什么是神经元网络？

什么是神经元网络控制？乍一听可能会以为这是用生物来控制了，其实不然，虽然也是智能的，但是这其实是**人工智能**，也就是说，神经元网络其实是一种软件形式

## 为什么要用神经元网络？

我们普通的 Controller 大多使用简单的控制方法，最终实现负反馈的调节，这些方法对某些简单的任务还是行之有效，但一旦遇到复杂问题时还是不得不挂掉了，这时候我们不得不更多的加入人的控制，但这就与自动化控制相矛盾了，我们想要做到的是，让控制系统尽可能的完成大多数任务，以减轻人类的负担，那么控制系统又如何能够像人那样完美的完成任务呢？难道给他安个大脑？嗯，已经离答案很近了

我们先看下人类的大脑，嗯，这样什么都看不出来，我们将局部放大一下，会发现大脑内部是由数以亿计的神经元相互连接构成的，我们抽出一个小的神经元拿出来看

![00](../Images/12_ACS_00.png)

它所做的只是接受到超过一个阈值的刺激之后，会产生兴奋，将信号向后传递

![01](../Images/12_ACS_01.png)

这么看也不难嘛，那我们可以同样的实现一个这样的人工神经元，在超过一定输入值后会产生输出

![02](../Images/12_ACS_02.png)

相似的，我们构建多个这样的神经元，将他们连接起来，这样就构成了一个神经网络

![03](../Images/12_ACS_03.png)

但是仅仅如此肯定还是不行的，因为这样的它是没有学习功能的，我们沿着网络的反方向进行反向传播，就可以对网络的参数进行优化

具体实现，其实就是求导，或者说偏微分，这个后面细说

## 如何训练神经网络？

当我们将一个这样的神经网络构建起来之后，我们只需要给他喂足够的数据，他就可以不断针对数据的特征进行拟合，最终获得一个准确的的映射关系

事实上，婴儿也是这样的，如果你有注意的话，会发现他们一出生是什么都不会的，但他们会通过视觉、听觉、味觉、嗅觉、触觉等感官获取环境的信息，在这个过程中不断学习，逐渐成长，也就是说，神经网络接收数据进行训练的过程大抵上可以类比于人类从外界获取信息的学习过程

那这样，我们把一个新的神经网络当成一个婴儿，当然，他什么都不会，这时候它看到一只猫，我们会教他，这是一只猫，但是下一次他并不一定记得，这时我们会悉心的教导他，这是一只猫，后来我们在问他这是什么的时候，他也许记得也许不记得，但是我们一次次的对他进行教导，他会自己从其中总结出规律，在若干年后，我们问他这是啥的时候，他依然可以自信的告诉我们，这就是一只猫

我们的神经网络的训练过程与此非常相似，我们将准备好的数据对，也就是这里的猫图以及正确答案猫，喂给这样的一个婴儿神经网络，神经网络会根据自己的预测以及真实答案之间的差距对自身参数进行优化

当然，这样一组数据是不足以让它记住的，我们使用大量的数据对不断地喂入神经网络，使得神经网络的参数不断优化，其预测值离真实答案越来越近，最终逐渐收敛于真实答案，这样我们就训练好了一个神经网络

## 神经网络的自优化

那么如何让神经网络优化自身参数，得到我们想要的特性呢？

我们再来看这样一个神经网络，嗯，最开始它只是一个婴儿，我们喂给它这样一个数据对 $(x, y)$

其中，将 $x$ 作为输入，经过神经网络中的一系列变换，它会输出 $f(x)$ ，我们称之为 $\hat{y}$ （这对应与前面婴儿的答案 $???$），但是 $x$ 对应的真实结果 $y$ （这对应于前面我们教婴儿“这是猫”）往往和 $\hat{y}$ 是有差距的，我们称这个差距为 $loss$ （损失）

比如说我们用最基本的平方误差函数来表征这个误差，也就是 $loss = (y - \hat{y})^2$ ，很明显，当这两个答案之间的差距越大，损失也就越大，我们的目标是减少这个差距，但是要如何减少呢？

很明显，我们的 $loss$ 是有一个最小值的，我们是想要对参数 $W$ 进行优化，使其对应的损失达到最小值，那么如何能使得 $loss$ 最快地收敛呢？

![04](../Images/12_ACS_04.png)

初始 $W$ 是随机的，也就是初始的 $loss$ 在随机的一个高度，比如说这里，我们可以让它每次沿着梯度降低最快的方向走一小步，直到最后收敛到损失的最低点

那么如何找到梯度最小的方向呢？在这里用切线表征了梯度的大小，简单地说，就是求导啦，在高维空间（因为我们的参数是高维的）下就是求偏导，细节不表，直接看公式吧~

-  $W -= \frac{\alpha \partial J(W, b)}{\partial w}$
-  $b -= \frac{\alpha \partial J(W, b)}{\partial b}$

## 如何应用在控制系统上

说了这么多，可是这要如何应用在控制系统上呢？我们知道神经网络很容易学习到一个映射关系，这要如何安到控制器上呢？

我们首先看基础的单回路闭环控制系统，就是由一个变送器、一个控制器、一个执行器简单组合而成

我们刚刚学过串级控制系统，它其实就是在单回路闭环控制系统上增加一个副回路，其中增加了一个副控制器和一个副变送器

下面我们看神经网络控制系统中最基本的神经网络监督控制，类似于串级控制系统，我们同样在单回路闭环控制系统上增加一个回路，该回路只增加一个控制器，但是它并不是普通的控制器，而是**神经网络控制器（NNC）**，虚线表示的是当前神经网路控制器并不启用，因为最开始神经网络还只像一个婴儿一样什么都不会，我们会在后续过程逐渐增加神经网络控制器的作用，降低控制器的作用

![05](../Images/12_ACS_05.png)

神经网络是需要足够的数据对它进行训练的，可是数据是如何获取的呢？我们将控制器接收到的信号传给神经网络控制器，控制器输出的信号作为输入信号的“答案”传给神经网络控制器，神经网络控制器会据此逐渐学习到控制器的调节特性，进而逐步取代原本的控制器

可是为什么要用这样一个“偷学”控制器技艺的神经网络控制器来取代原来的控制器呢？因为实际生产应用中难免会发生很多意外情况，而神经网络在学习过程中不仅学习到了控制器本身的控制特性，还学习到了对意外情况的处理方式，这确保了控制系统的稳定性和鲁棒性，更提高了系统的精度和自适应能力，这也可以说是“青出于蓝”了

当然，神经网络监督控制系统只是最基本的神经网络控制系统，除此之外，当前还有有以下几种常见的基于神经网络的控制系统

-  全局逼近神经网络
-  局部逼近神经网络
-  模糊神经网络

## 对神经网络应用的展望

如今，深度学习技术使得人工智能掀起了新的热潮，近年来有很多新的神经网络模型诞生并应用，比如擅长识别图片的卷积神经网络 $CNN$，擅长识别序列的循环神经网络 $RNN$，擅长生成数据的生成对抗网络 $GAN$，擅长研究内在联系的图神经网络 $GNN$ 等等，这使得很多原来难以解决的问题变得更加容易，相信不久的将来，AI 能够更好地为人类赋能，逐渐地构建一个人工智能驱动的社会

# Reference

1. 材料成型过程检测及控制课程 张宇博老师
2. deeplearning.ai Andrew Ng
